<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8" />
    <title>UC02 - Tra c·ª©u & xem l·ªãch chi·∫øu</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
        }

        body {
            margin: 0;
            background: #f3f4f6;
            color: #111827;
        }

        header {
            padding: 12px 24px;
            background: #111827;
            color: #f9fafb;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        header h1 {
            margin: 0;
            font-size: 18px;
        }

        header .sub {
            font-size: 12px;
            opacity: 0.8;
        }

        main {
            padding: 16px 24px 32px;
        }

        .layout {
            display: grid;
            grid-template-columns: minmax(0, 2fr) minmax(260px, 1fr);
            gap: 16px;
            align-items: flex-start;
        }

        @media (max-width: 900px) {
            .layout {
                grid-template-columns: 1fr;
            }
        }

        .card {
            background: #ffffff;
            border-radius: 14px;
            padding: 14px 16px 16px;
            box-shadow: 0 1px 6px rgba(15, 23, 42, 0.08);
        }

        .filters {
            display: grid;
            grid-template-columns: repeat(4, minmax(0, 1fr));
            gap: 8px 12px;
            margin-bottom: 8px;
        }

        @media (max-width: 900px) {
            .filters {
                grid-template-columns: repeat(2, minmax(0, 1fr));
            }
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 4px;
            font-size: 12px;
        }

        .filter-group label {
            color: #6b7280;
        }

        .filter-group select,
        .filter-group input[type="date"],
        .filter-group input[type="time"],
        .filter-group input[type="text"] {
            padding: 5px 8px;
            border-radius: 8px;
            border: 1px solid #d1d5db;
            font-size: 13px;
        }

        .filter-row {
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            gap: 12px;
            margin-bottom: 10px;
        }

        .search-group {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 4px;
            font-size: 12px;
        }

        .search-box {
            display: flex;
            border-radius: 999px;
            border: 1px solid #d1d5db;
            overflow: hidden;
            background: #fff;
        }

        .search-box input {
            flex: 1;
            border: none;
            padding: 6px 10px;
            font-size: 13px;
            outline: none;
        }

        .search-box span {
            padding: 0 10px;
            font-size: 12px;
            color: #6b7280;
            display: flex;
            align-items: center;
        }

        .summary-row {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 10px;
        }

        .summary-item {
            flex: 1;
            min-width: 140px;
            border-radius: 10px;
            background: #f9fafb;
            border: 1px solid #e5e7eb;
            padding: 6px 10px;
            font-size: 12px;
        }

        .summary-label {
            color: #6b7280;
            margin-bottom: 2px;
        }

        .summary-value {
            font-weight: 600;
        }

        .badge {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            border-radius: 999px;
            padding: 2px 8px;
            font-size: 10px;
            background: #eef2ff;
            color: #3730a3;
        }

        .badge-hot {
            background: #fee2e2;
            color: #b91c1c;
        }

        .badge-calm {
            background: #ecfdf3;
            color: #15803d;
        }

        .badge-format {
            background: #ecfeff;
            color: #0f766e;
        }

        .badge-status {
            background: #eff6ff;
            color: #1d4ed8;
        }

        .readonly-note {
            font-size: 11px;
            color: #6b7280;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }

        .dot {
            width: 8px;
            height: 8px;
            border-radius: 999px;
            background: #10b981;
        }

        .showtime-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-top: 8px;
        }

        .showtime-item {
            border-radius: 10px;
            border: 1px solid #e5e7eb;
            padding: 8px 10px;
            display: grid;
            grid-template-columns: 70px minmax(0, 1.4fr) minmax(0, 1.2fr);
            gap: 8px;
            align-items: center;
            font-size: 12px;
            background: #fff;
        }

        @media (max-width: 800px) {
            .showtime-item {
                grid-template-columns: 60px minmax(0, 1.6fr);
                grid-template-rows: auto auto;
            }
        }

        .showtime-time {
            font-weight: 700;
        }

        .showtime-main {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .showtime-movie {
            font-weight: 600;
        }

        .showtime-meta {
            font-size: 11px;
            color: #4b5563;
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
        }

        .showtime-stats {
            display: flex;
            flex-direction: column;
            gap: 4px;
            font-size: 11px;
        }

        .progress-bar {
            position: relative;
            width: 100%;
            height: 6px;
            border-radius: 999px;
            background: #e5e7eb;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            border-radius: 999px;
            background: linear-gradient(90deg, #22c55e, #eab308, #ef4444);
            width: 50%;
        }

        .stats-line {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .stats-label {
            color: #6b7280;
        }

        .stats-value {
            font-weight: 600;
        }

        .side-card h3 {
            margin: 0 0 6px;
            font-size: 14px;
        }

        .side-card p {
            margin: 0 0 8px;
            font-size: 12px;
            color: #4b5563;
        }

        .side-card ul {
            margin: 0;
            padding-left: 18px;
            font-size: 12px;
            color: #4b5563;
        }

        .no-result {
            margin-top: 8px;
            font-size: 12px;
            color: #6b7280;
            font-style: italic;
        }
    </style>
</head>
<body>
<header>
    <div>
        <h1>UC02 - Tra c·ª©u & xem l·ªãch chi·∫øu</h1>
        <div class="sub">Ch·∫ø ƒë·ªô ch·ªâ xem (d√πng cho Nh√¢n vi√™n b√°n v√© / Qu·∫£n l√Ω khi c·∫ßn tra c·ª©u nhanh)</div>
    </div>
    <div class="badge">
        ROLE: Nh√¢n vi√™n b√°n v√© / Qu·∫£n l√Ω
    </div>
</header>

<main>
    <div class="layout">
        <!-- C·ªôt ch√≠nh: b·ªô l·ªçc + danh s√°ch su·∫•t -->
        <section class="card">
            <!-- H√†ng filters tr√™n -->
            <div class="filters">
                <div class="filter-group">
                    <label for="clusterSelect">C·ª•m r·∫°p</label>
                    <select id="clusterSelect">
                        <option value="MB">Mi·ªÅn B·∫Øc</option>
                        <option value="MT">Mi·ªÅn Trung</option>
                        <option value="MN">Mi·ªÅn Nam</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="cinemaSelect">R·∫°p</label>
                    <select id="cinemaSelect">
                        <option value="timecity">XYZ Time City</option>
                        <option value="royal">XYZ Royal City</option>
                        <option value="batrieu">XYZ Vincom B√† Tri·ªáu</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="roomSelect">Ph√≤ng chi·∫øu</label>
                    <select id="roomSelect">
                        <option value="">T·∫•t c·∫£ ph√≤ng</option>
                        <option value="1">Ph√≤ng 1</option>
                        <option value="2">Ph√≤ng 2</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="dateSelect">Ng√†y</label>
                    <input type="date" id="dateSelect" />
                </div>
            </div>

            <!-- H√†ng t√¨m ki·∫øm + khung gi·ªù + ƒë·ªãnh d·∫°ng -->
            <div class="filter-row">
                <div class="search-group">
                    <label for="searchInput">T√¨m theo t√™n phim</label>
                    <div class="search-box">
                        <span>üîç</span>
                        <input type="text" id="searchInput" placeholder="Nh·∫≠p t√™n phim (v√≠ d·ª•: Mai, Dune, Conan)..." />
                    </div>
                </div>
                <div class="filter-group" style="max-width: 160px;">
                    <label for="timeFrom">T·ª´ gi·ªù</label>
                    <input type="time" id="timeFrom" value="00:00" />
                </div>
                <div class="filter-group" style="max-width: 160px;">
                    <label for="timeTo">ƒê·∫øn gi·ªù</label>
                    <input type="time" id="timeTo" value="23:59" />
                </div>
                <div class="filter-group" style="max-width: 160px;">
                    <label for="formatSelect">ƒê·ªãnh d·∫°ng</label>
                    <select id="formatSelect">
                        <option value="">T·∫•t c·∫£</option>
                        <option value="2D">2D</option>
                        <option value="3D">3D</option>
                        <option value="IMAX">IMAX</option>
                    </select>
                </div>
            </div>

            <div class="readonly-note">
                <span class="dot"></span>
                M√†n h√¨nh ch·ªâ tra c·ª©u ‚Äì kh√¥ng c√≥ thao t√°c Th√™m/S·ª≠a/X√≥a su·∫•t chi·∫øu.
            </div>

            <!-- T√≥m t·∫Øt nhanh -->
            <div class="summary-row" id="summaryRow">
                <div class="summary-item">
                    <div class="summary-label">S·ªë su·∫•t chi·∫øu trong ng√†y</div>
                    <div class="summary-value" id="sumShows">0 su·∫•t</div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">T·ª∑ l·ªá l·∫•p ƒë·∫ßy trung b√¨nh</div>
                    <div class="summary-value" id="sumOccupancy">0%</div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">Su·∫•t ƒë√¥ng kh√°ch nh·∫•t</div>
                    <div class="summary-value" id="sumHottest">-</div>
                </div>
            </div>

            <!-- Danh s√°ch su·∫•t chi·∫øu -->
            <div id="showtimeList" class="showtime-list"></div>
            <div id="noResult" class="no-result" style="display:none;">
                Kh√¥ng t√¨m th·∫•y su·∫•t chi·∫øu n√†o kh·ªõp ƒëi·ªÅu ki·ªán l·ªçc.
            </div>
        </section>

        <!-- C·ªôt ph·∫£i: gi·∫£i th√≠ch UC & c√°ch d√πng -->
        <aside class="card side-card">
            <h3>M·ª•c ti√™u c·ªßa UC02</h3>
            <p>
                Use Case n√†y ƒë∆∞·ª£c d√πng khi nh√¢n vi√™n b√°n v√© ho·∫∑c qu·∫£n l√Ω c·∫ßn <strong>tra c·ª©u nhanh l·ªãch chi·∫øu</strong> theo
                ng√†y/r·∫°p/ph√≤ng ƒë·ªÉ t∆∞ v·∫•n cho kh√°ch ho·∫∑c theo d√µi t√¨nh h√¨nh su·∫•t.
            </p>
            <ul>
                <li>T√¨m phim theo t·ª´ kh√≥a (v√≠ d·ª•: <em>"Dune"</em>, <em>"Mai"</em>, <em>"Conan"</em>)</li>
                <li>L·ªçc theo c·ª•m r·∫°p, r·∫°p, ph√≤ng chi·∫øu, ng√†y, khung gi·ªù, ƒë·ªãnh d·∫°ng</li>
                <li>Xem s·ªë gh·∫ø ƒë√£ b√°n / c√≤n tr·ªëng, m·ª©c ƒë·ªô ƒë√¥ng kh√°ch t·ª´ng su·∫•t</li>
                <li>D√πng th√¥ng tin n√†y ƒë·ªÉ d·∫´n kh√°ch sang b∆∞·ªõc <em>ƒê·∫∑t v√©</em> (Use Case kh√°c)</li>
            </ul>
            <p style="margin-top:8px;">
                ƒê√¢y l√† <strong>m√†n h√¨nh ch·ªâ ƒë·ªçc</strong> ‚Äì kh√¥ng ch·ªânh s·ª≠a c·∫•u h√¨nh l·ªãch chi·∫øu.  
                C√°c thao t√°c t·∫°o/s·ª≠a/x√≥a su·∫•t chi·∫øu thu·ªôc v·ªÅ <strong>UC01 ‚Äì Qu·∫£n l√Ω l·ªãch chi·∫øu</strong>.
            </p>
        </aside>
    </div>
</main>

<script>
    // ======= D·ªÆ LI·ªÜU DEMO =======
    const demoShows = [
        {
            id: 1,
            movie: "MAI",
            time: "09:00",
            room: "1",
            cinema: "timecity",
            cluster: "MB",
            format: "2D",
            lang: "Ph·ª• ƒë·ªÅ",
            totalSeats: 120,
            soldSeats: 45,
            status: "ƒêang nh·∫≠n kh√°ch"
        },
        {
            id: 2,
            movie: "DUNE: PH·∫¶N HAI",
            time: "13:30",
            room: "1",
            cinema: "timecity",
            cluster: "MB",
            format: "IMAX",
            lang: "Ph·ª• ƒë·ªÅ",
            totalSeats: 180,
            soldSeats: 160,
            status: "S·∫Øp h·∫øt ch·ªó"
        },
        {
            id: 3,
            movie: "CONAN: T√ÄU NG·∫¶M S·∫ÆT M√ÄU ƒêEN",
            time: "15:45",
            room: "2",
            cinema: "timecity",
            cluster: "MB",
            format: "2D",
            lang: "L·ªìng ti·∫øng",
            totalSeats: 100,
            soldSeats: 70,
            status: "ƒê√¥ng kh√°ch"
        },
        {
            id: 4,
            movie: "INSIDE OUT 2",
            time: "18:00",
            room: "1",
            cinema: "timecity",
            cluster: "MB",
            format: "3D",
            lang: "L·ªìng ti·∫øng",
            totalSeats: 120,
            soldSeats: 30,
            status: "V·∫Øng kh√°ch"
        },
        {
            id: 5,
            movie: "DEADPOOL & WOLVERINE",
            time: "20:15",
            room: "2",
            cinema: "timecity",
            cluster: "MB",
            format: "2D",
            lang: "Ph·ª• ƒë·ªÅ",
            totalSeats: 100,
            soldSeats: 95,
            status: "R·∫•t ƒë√¥ng"
        }
    ];

    // ======= L·∫§Y ELEMENT =======
    const showtimeList = document.getElementById("showtimeList");
    const noResult = document.getElementById("noResult");
    const sumShows = document.getElementById("sumShows");
    const sumOccupancy = document.getElementById("sumOccupancy");
    const sumHottest = document.getElementById("sumHottest");

    const clusterSelect = document.getElementById("clusterSelect");
    const cinemaSelect = document.getElementById("cinemaSelect");
    const roomSelect = document.getElementById("roomSelect");
    const dateSelect = document.getElementById("dateSelect");
    const searchInput = document.getElementById("searchInput");
    const timeFrom = document.getElementById("timeFrom");
    const timeTo = document.getElementById("timeTo");
    const formatSelect = document.getElementById("formatSelect");

    // ======= H√ÄM H·ªñ TR·ª¢ =======
    function timeToMinutes(t) {
        const [h, m] = t.split(":").map(Number);
        return h * 60 + m;
    }

    function getBadgeHot(occ) {
        if (occ >= 80) return '<span class="badge badge-hot">üî• R·∫•t ƒë√¥ng kh√°ch</span>';
        if (occ >= 50) return '<span class="badge badge-status">ƒê√¥ng v·ª´a</span>';
        if (occ >= 20) return '<span class="badge badge-calm">Kh√° v·∫Øng</span>';
        return '<span class="badge badge-calm">R·∫•t v·∫Øng</span>';
    }

    // ======= RENDER DANH S√ÅCH SU·∫§T =======
    function renderList() {
        // L·ªçc d·ªØ li·ªáu theo c√°c ƒëi·ªÅu ki·ªán
        const keyword = searchInput.value.trim().toLowerCase();
        const cluster = clusterSelect.value;
        const cinema = cinemaSelect.value;
        const room = roomSelect.value;
        const fmt = formatSelect.value;
        const fromM = timeToMinutes(timeFrom.value || "00:00");
        const toM = timeToMinutes(timeTo.value || "23:59");

        let filtered = demoShows.filter(s => {
            if (cluster && s.cluster !== cluster) return false;
            if (cinema && s.cinema !== cinema) return false;
            if (room && s.room !== room) return false;
            if (fmt && s.format !== fmt) return false;

            const timeM = timeToMinutes(s.time);
            if (timeM < fromM || timeM > toM) return false;

            if (keyword && !s.movie.toLowerCase().includes(keyword)) return false;

            return true;
        });

        showtimeList.innerHTML = "";

        if (filtered.length === 0) {
            noResult.style.display = "block";
            sumShows.textContent = "0 su·∫•t";
            sumOccupancy.textContent = "0%";
            sumHottest.textContent = "-";
            return;
        } else {
            noResult.style.display = "none";
        }

        // T√≠nh summary
        const totalShows = filtered.length;
        let occSum = 0;
        let hottest = filtered[0];
        let maxOcc = 0;

        filtered.forEach(s => {
            const occ = Math.round((s.soldSeats / s.totalSeats) * 100);
            occSum += occ;
            if (occ > maxOcc) {
                maxOcc = occ;
                hottest = s;
            }
        });

        sumShows.textContent = `${totalShows} su·∫•t`;
        sumOccupancy.textContent = `${Math.round(occSum / totalShows)}%`;
        sumHottest.textContent = `${hottest.time} ‚Äì ${hottest.movie}`;

        // Render t·ª´ng su·∫•t
        filtered.forEach(s => {
            const occ = Math.round((s.soldSeats / s.totalSeats) * 100);
            const left = s.totalSeats - s.soldSeats;

            const item = document.createElement("div");
            item.className = "showtime-item";

            const timeCol = document.createElement("div");
            timeCol.className = "showtime-time";
            timeCol.textContent = s.time;
            item.appendChild(timeCol);

            const mainCol = document.createElement("div");
            mainCol.className = "showtime-main";
            mainCol.innerHTML = `
                <div class="showtime-movie">${s.movie}</div>
                <div class="showtime-meta">
                    <span class="badge badge-format">${s.format}</span>
                    <span>${s.lang}</span>
                    <span>‚Ä¢ Ph√≤ng ${s.room}</span>
                    <span>‚Ä¢ ${s.status}</span>
                </div>
            `;
            item.appendChild(mainCol);

            const statsCol = document.createElement("div");
            statsCol.className = "showtime-stats";
            statsCol.innerHTML = `
                <div class="stats-line">
                    <span class="stats-label">ƒê√£ b√°n / T·ªïng:</span>
                    <span class="stats-value">${s.soldSeats}/${s.totalSeats}</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: ${occ}%"></div>
                </div>
                <div class="stats-line">
                    <span class="stats-label">C√≤n l·∫°i:</span>
                    <span>${left} gh·∫ø</span>
                </div>
                <div>${getBadgeHot(occ)}</div>
            `;
            item.appendChild(statsCol);

            showtimeList.appendChild(item);
        });
    }

    // ======= INIT =======
    // Set ng√†y m·∫∑c ƒë·ªãnh = h√¥m nay
    const today = new Date();
    dateSelect.value = today.toISOString().split("T")[0];

    [clusterSelect, cinemaSelect, roomSelect, dateSelect, searchInput, timeFrom, timeTo, formatSelect]
        .forEach(el => el.addEventListener("input", renderList));

    renderList();
</script>
</body>
</html>
